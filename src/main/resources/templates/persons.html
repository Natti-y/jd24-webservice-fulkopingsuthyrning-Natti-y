<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Pokemon Card Rentals</title>
</head>
<body>
<h1>Pokemon Cards for Rent</h1>

<table border="1">
    <tr>
        <th>Name</th>
        <th>Description</th>
        <th>Current Loans</th>
        <th>Loan Card</th>
    </tr>
    <tr th:each="card : ${cards}">
        <td th:text="${card.namn}"></td>
        <td th:text="${card.beskrivning}"></td>
        <td>
            <ul>
                <li th:each="loan : ${card.loans}">
                    <span th:text="${loan.person.namn}"></span>:
                    <span th:text="${#temporals.format(loan.startAt, 'yyyy-MM-dd HH:mm')}"></span>
                    <span th:text="${#temporals.format(loan.endAt, 'yyyy-MM-dd HH:mm')}"></span>
                </li>
                <li th:if="${#lists.isEmpty(card.loans)}">No loans</li>
            </ul>
        </td>
        <td>
            <form th:action="@{/cards/loan}" method="post">
                <input type="hidden" th:name="cardId" th:value="${card.id}" />
                <select name="personId" required>
                    <option value="" disabled selected>Select a person</option>
                    <option th:each="person : ${persons}"
                            th:value="${person.id}"
                            th:text="${person.namn}"></option>
                </select>
                <input type="datetime-local" name="startAt" required />
                <input type="datetime-local" name="endAt" required />
                <button type="submit">Loan</button>
            </form>
        </td>
    </tr>
</table>

<!-- Optional messages -->
<div th:if="${param.success}">
    <p>Loan created successfully!</p>
</div>
<div th:if="${param.error}">
    <p>Error creating loan. Check input.</p>
</div>

</body>
</html>
